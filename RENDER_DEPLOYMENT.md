# üé® Render Deployment Guide for RUDE.AI Bot

Deploy your RUDE.AI Telegram bot to Render's free tier with PostgreSQL database.

## ‚úÖ Why Render?

- **Free tier perfect for bots** - No health check issues like Railway
- **Free PostgreSQL** - 90 days free database
- **GitHub auto-deployment** - Automatic deploys from your repo
- **Simple setup** - No complex configuration needed
- **Reliable uptime** - Great for production bots

## üöÄ Quick Start

### 1. Prepare Your Repository

Your repo is already configured with:
- ‚úÖ `render.yaml` - Render service configuration
- ‚úÖ `requirements.txt` - Python dependencies
- ‚úÖ Environment detection - Auto-detects Render deployment
- ‚úÖ PostgreSQL support - Production database ready

### 2. Deploy to Render

#### Step 1: Create Web Service

1. Go to [render.com](https://render.com) and sign in with GitHub
2. Click **"New"** ‚Üí **"Web Service"**
3. Connect your GitHub repository
4. Select your `rudeai-bot` repository
5. Configure service:
   - **Name**: `rudeai-bot` (or your preferred name)
   - **Runtime**: `Python 3`
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `python -m uvicorn rudeai_bot.webhook_server:app --host 0.0.0.0 --port $PORT`
   - **Plan**: `Free` (perfect for Telegram bots)

#### Step 2: Create PostgreSQL Database

1. In Render dashboard, click **"New"** ‚Üí **"PostgreSQL"**
2. Configure database:
   - **Name**: `rudeai-bot-db`
   - **Database Name**: `rudeai_bot`
   - **User**: `rudeai_user`
   - **Plan**: `Free` (90 days)
3. **Save the DATABASE_URL** - you'll need it for environment variables

#### Step 3: Set Environment Variables

In your web service settings, add these environment variables:

**üîê Secrets (mark as secret):**
```bash
OPENAI_API_KEY=your_openai_api_key_here
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
WEBHOOK_SECRET=your_generated_webhook_secret
```

**üîó URLs:**
```bash
WEBHOOK_URL=https://your-service-name.onrender.com
DATABASE_URL=postgresql://user:pass@host:port/db  # From PostgreSQL service
```

**‚öôÔ∏è Configuration:**
```bash
ENVIRONMENT=production
DEBUG=false
HOST=0.0.0.0
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=40
OPENAI_TEMPERATURE=0.7
RATE_LIMIT_PER_MINUTE=20
MAX_MESSAGE_LENGTH=1000
LOG_LEVEL=INFO
ENABLE_METRICS=true
METRICS_RETENTION_DAYS=7
```

### 3. Deploy & Test

1. Click **"Create Web Service"**
2. Render will automatically build and deploy your bot
3. Monitor the build logs for any errors
4. Once deployed, test with your bot on Telegram

## üîß Helper Scripts

### Generate Environment Variables
```bash
./deploy_render.sh env
```

### Show Setup Instructions
```bash
./deploy_render.sh setup
```

### Generate Webhook Secret
```bash
./deploy_render.sh webhook
```

### Run Diagnostics
```bash
./deploy_render.sh check
```

## üìã Environment Variables Reference

### Required Secrets
| Variable | Description | Example |
|----------|-------------|---------|
| `OPENAI_API_KEY` | Your OpenAI API key | `sk-...` |
| `TELEGRAM_BOT_TOKEN` | Bot token from @BotFather | `123456789:ABC...` |
| `WEBHOOK_SECRET` | Random 64-char string | `abc123...` |

### URLs & Database
| Variable | Description | Source |
|----------|-------------|--------|
| `WEBHOOK_URL` | Your Render service URL | `https://rudeai-bot.onrender.com` |
| `DATABASE_URL` | PostgreSQL connection string | Auto-generated by Render |

### Configuration
| Variable | Default | Description |
|----------|---------|-------------|
| `ENVIRONMENT` | `production` | Runtime environment |
| `DEBUG` | `false` | Enable debug logging |
| `OPENAI_MODEL` | `gpt-4o-mini` | OpenAI model to use |
| `OPENAI_MAX_TOKENS` | `40` | Max response tokens |
| `RATE_LIMIT_PER_MINUTE` | `20` | Rate limit per user |

## üîç Troubleshooting

### Common Issues

**Build Fails:**
- Check `requirements.txt` for missing dependencies
- Verify Python version compatibility
- Check build logs for specific errors

**Bot Doesn't Respond:**
- Verify `TELEGRAM_BOT_TOKEN` is correct
- Check webhook URL matches your Render service URL
- Ensure all required environment variables are set

**Database Errors:**
- Verify `DATABASE_URL` from PostgreSQL service
- Check database connection in logs
- Ensure PostgreSQL service is running

### Debugging Commands

**Check service logs:**
```bash
# In Render dashboard ‚Üí Service ‚Üí Logs
# Look for startup messages and errors
```

**Test bot status:**
```bash
python3 check_bot_status.py
```

**Verify webhook:**
```bash
curl https://your-service-name.onrender.com/health
```

## üìä Monitoring

### Health Endpoints

Your bot automatically provides these endpoints:

- `/health` - Health check status
- `/` - Basic service information
- `/ping` - Simple connectivity test
- `/status` - Detailed system status

### Logs

Monitor your bot through:
- **Render Dashboard** ‚Üí Your Service ‚Üí Logs
- Real-time log streaming
- Error tracking and debugging

## üí∞ Render Free Tier Limits

**Web Service:**
- ‚úÖ 750 hours/month compute time
- ‚úÖ Automatic sleep after 15 minutes of inactivity
- ‚úÖ Custom domains supported
- ‚úÖ GitHub auto-deployment

**PostgreSQL:**
- ‚úÖ 90 days free
- ‚úÖ 1GB storage
- ‚úÖ 5 concurrent connections
- ‚úÖ Daily automated backups

## üöÄ Production Tips

### Keeping Your Service Active

Free tier services sleep after 15 minutes of inactivity. For a Telegram bot, this is usually fine since:
- Telegram webhooks wake up the service
- Cold start time is typically < 30 seconds
- Most bot interactions are sporadic

### Upgrading Later

When you need more reliability:
- Upgrade to **Starter plan** ($7/month)
- No sleep, always-on service
- More compute resources
- Priority support

## üìû Support

### Render Support
- [Render Documentation](https://render.com/docs)
- [Render Community](https://community.render.com)
- [Render Status](https://status.render.com)

### Bot Issues
- Check service logs in Render dashboard
- Test endpoints manually
- Verify environment variables
- Run local diagnostics with `./deploy_render.sh check`

---

**üéâ Congratulations!** Your RUDE.AI bot is now running on Render with PostgreSQL database support and GitHub auto-deployment!